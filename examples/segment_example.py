"""Example usage of the milvus_segment_generator library."""

from pathlib import Path
from milvus_segment_generator import segment_text, segment_text_to_json, list_supported_languages


def get_segmented_text(text: str, lang: str, segment_size: int):
    spans, segments = segment_text(text, lang, segment_size)
    return spans, segments


if __name__ == "__main__":
    # text_dirs = list(Path("data/input").iterdir())
    # text_dirs.sort()
    # for text_dir in text_dirs:
    #     text_title = text_dir.stem
    #     text_path = list(text_dir.glob("*.txt"))[0]
    text = "སངས་རྒྱས་ལ་བསྟོད་པ་གང་ཚེ་རྐང་གཉིས་མ་ཟེར་བ་དེ་རེད།ནམ་ཞིག་མི་ཚང་མའི་གཙོ་བོ་ཁྱོད་སྐྱེ་དུས། ས་གཞི་འདིའི་ཐོག་ལ་གོམ་པ་བདུན་སྤོས་ནས། ‘འཇིག་རྟེན་འདིའི་ནང་ལ་ང་རང་གཙོ་བོ་ཡིན།’ ཟེར་ནས་ལབ་པ་རེད། དུས་དེར་མཁས་པ་ཁྱོད་ལ་ཕྱག་འཚལ་གྱི་ཡོད།དང་པོ་དགའ་ལྡན་ལྷའི་ཡུལ་ནས་ཡོང་། རྒྱལ་པོའི་ཕོ་བྲང་ནང་ལ་ཨ་མའི་མངལ་དུ་འཛུལ། ལུམྦི་ནི་སྐྱེད་མོས་ཚལ་ནང་ལ་སྐྱེས། ལྷ་ཚང་མའི་ནང་གི་ལྷ་ཆེ་ཤོས་ཁྱོད་ལ་ཕྱག་འཚལ་གྱི་ཡོད།ཕོ་བྲང་ནང་ལ་མ་མ་སུམ་ཅུ་སོ་གཉིས་ཀྱིས་ལྟ་སྐྱོང་བྱས། ཤཱཀྱའི་གྲོང་ཁྱེར་ནང་ལ་གཞོན་ནུ་སྐབས་ཀྱི་རྩེད་མོ་བརྩེས། སེར་སྐྱའི་གྲོང་ཁྱེར་ནང་ལ་ས་འཚོ་མ་ཟེར་བ་དེ་མནའ་མར་བླངས། འཇིག་རྟེན་འདིའི་ནང་ལ་འགྲན་ཟླ་མེད་པ་ཁྱོད་ལ་ཕྱག་འཚལ་གྱི་ཡོད།གྲོང་ཁྱེར་གྱི་སྒོ་བཞིའི་ནང་ལ་ཕྱིན་ནས་སེམས་སྐྱོ་པོ་ཆགས་པའི་རྣམ་འགྱུར་བསྟན། མཆོད་རྟེན་རྣམ་དག་ཟེར་བའི་འགྲམ་ལ་རང་གི་སྐྲ་བྲེགས། ནཻ་རཉྫ་ནཱ་ཟེར་བའི་གཙང་པོའི་འགྲམ་ལ་ལུས་སེམས་ལ་དཀའ་ལས་བཏང་ནས་སྒོམ་བརྒྱབ། སེམས་ཀྱི་སྐྱོན་ཚང་མ་མེད་པ་ཁྱོད་ལ་ཕྱག་འཚལ་གྱི་ཡོད།རྒྱལ་པོའི་ཁབ་ཟེར་བའི་ས་ཆ་དེར་གླང་ཆེན་སྨྱོན་པ་ཞིག་བཏུལ། ཡངས་པ་ཅན་ཟེར་བའི་ས་ཆ་དེར་སྤྲེའུ་ཞིག་གིས་སྦྲང་རྩི་ཕུལ། མ་ག་དྷ་ཟེར་བའི་ས་ཆ་དེར་སངས་རྒྱས། ཤེས་རབ་མེ་ནང་བཞིན་འབར་མཁན་ཁྱོད་ལ་ཕྱག་འཚལ་གྱི་ཡོད།ཝཱ་ར་ཎཱ་སི་ལ་དང་པོ་ཆོས་བཤད། ཛེ་ཏའི་ཚལ་ཟེར་བའི་ནང་ལ་རྫུ་འཕྲུལ་ཆེན་པོ་བསྟན། རྩྭ་མཆོག་གྲོང་ཟེར་བའི་ས་ཆ་དེར་གྲོངས། སེམས་ནམ་མཁའ་ནང་བཞིན་ཡངས་པ་ཁྱོད་ལ་ཕྱག་འཚལ་གྱི་ཡོད།ངས་སངས་རྒྱས་ཀྱི་བྱ་བ་བྱས་པ་ཚོ་ལ་བསྟོད་པ་ཐུང་ཐུང་འདི་བྲིས་པའི་དགེ་བ་འདིས། སེམས་ཅན་ཚང་མའི་བྱ་སྤྱོད་ཚང་མ་ཡང་སངས་རྒྱས་ཀྱི་བྱ་སྤྱོད་ནང་བཞིན་ཏག་ཏག་ཆགས་པར་ཤོག བསྟོད་པ་འདི་སློབ་དཔོན་དཔའ་བོ་ཟེར་མཁན་དེས་བྲིས་པ་རེད།"
    text = text.replace("\n", "")
    text = text.replace("་ ", "")
    lang = 'bo'
    segment_size = 1990
    spans, segments = get_segmented_text(text, lang, segment_size)
    output_path = Path("data/output") / f"{text_title}.txt"
    output_path.write_text(segments, encoding="utf-8")
    print(f"Done {text_title}")
    print("Done all")